<div class="container">
  <div class="row align-items-center justify-content-center">
    <div class="row align-items-center justify-content-center">
      <div class="col-lg-6">

          <% if nurse_signed_in? %>
            <h2><%= @chat_room.hospital.name %>さんとのメッセージ</h2>
          <% elsif hospital_signed_in? %>
            <h2><%= @chat_room.nurse.display_name(@chat_room.nurse) %>さんとのメッセージ</h2>
          <% end %>

      </div>
    </div>
      <!--メッセージの送り手が看護師の場合sender == true、病院の場合sender == false-->
      <!--true、false自分が送った方のメッセージを判断し右寄せにする-->
      <% @chats.each do |chat| %>
        <div class="row align-items-center justify-content-center">
          <% if nurse_signed_in? %>
            <% if chat.sender == true %>
            <!--自分は看護師で、自分が送ったメッセージのため右寄せ-->
              <div class="col-10 ml-auto">
                <div class="my_message">
                <%= chat.message %>
                  <div class="my_down_triangle">
                    ▶
                  </div>
                </div>
                <div class="col-10 ml-auto">
                <%= chat.created_at %>
                <%= image_tag current_nurse.get_image(40,40), class: "rounded-circle" %></div>
              </div>
            <% else %>
            <!--自分は看護師で、相手の病院が送ったメッセージのため左寄せ-->
              <div class="col-10 mr-auto">
                <div class="your_message">
                  <%= chat.message %>
                  <div class="your_down_triangle">
                      ◀
                  </div>
                </div>
                <div class="col-10 mr-auto">
                <%= chat.created_at %>
                <%= image_tag @chat_room.hospital.get_image(40,40), class: "rounded-circle" %>
                </div>
              </div>
            <% end %>
          <% elsif hospital_signed_in? %>
          <!--自分は病院で、自分が送ったメッセージのため右寄せ-->
              <% if chat.sender == false %>
                <div class="col-10 ml-auto">
                  <div class="my_message">
                    <%= chat.message %>
                    <div class="my_down_triangle">
                      ▶
                    </div>
                  </div>
                  <div class="col-10 ml-auto">
                    <%= chat.created_at %>
                    <%= image_tag current_hospital.get_image(40,40), class: "rounded-circle" %>
                  </div>
                </div>
              <% else %>
              <!--自分は病院で、相手の看護師が送ったメッセージのため左寄せ-->
                <div class="col-10 mr-auto">
                  <div class="your_message">
                    <%= chat.message %>
                    <div class="your_down_triangle">
                      ◀
                    </div>
                  </div>
                  <div class="col-10 mr-auto">
                    <%= chat.created_at %>
                    <%= image_tag @chat_room.nurse.get_image(40,40), class: "rounded-circle" %>
                  </div>
                </div>
              <% end %>
          <% end %>
        </div>
      <% end %>
      <%= form_with model:@chat, methot: :post, url: chat_room_chats_path(params[:chat_room_id]), local: true do |f| %>
        <% if nurse_signed_in? %>
          <%= f.hidden_field :sender, value: :true %>
        <% elsif %>
          <%= f.hidden_field :sender, value: :false %>
        <% end %>
        <div class="row align-items-center justify-content-center">
          <div class="col-8">
            <%= f.text_field :message, class:"form-control" %>

          </div>
          <div class="col-2">
            <%= f.submit "送信" %>
          </div>
        </div>
      <% end %>
  </div>
</div>
